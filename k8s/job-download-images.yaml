apiVersion: batch/v1
kind: Job
metadata:
  name: download-images
spec:
  backoffLimit: 0
  completions: 10  # FIXME
  parallelism: 10  # FIXME
  template:
    spec:
      containers:
      - name: image-downloader
        image: hotohoto/minidalle2:0.1.0-cpu
        command: ["venv/bin/poe", "download_images"]
        volumeMounts:
        - name: vol
          mountPath: /home/worker/minidalle2/datasets
      restartPolicy: Never
      volumes:
      - name: vol
        persistentVolumeClaim:
          claimName: pvc-minidalle2-datasets-rwx
      securityContext:
        fsGroup: 1000  # mount volumes with the group ID set
